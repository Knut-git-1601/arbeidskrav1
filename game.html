<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arbeidskrav 1!</title>
    <link rel="stylesheet" href="game.css" />
  </head>
  <!-- HTML KODEN TRENGER DU IKKE RØRE FOR Å LØSE OPPGAVENE. -->

  <body>
    <div class="main-container">                                                            <!-- Container for hele spillet -->
                                                                                            <!-- Healthbars til heroene -->
      <div class="hero-health-containers">                                                  <!-- Container for alle heltene -->
        <div class="healthbar-container">                                                   <!-- Container for hver enkelt helt -->
                                                                                            <!-- healer-health sin vidde må forandres for å endre lifebar -->
          <div class="healthbar healer-health"></div>                                       <!-- Lifebar for healer -->
          <div class="text-container">                                                      <!-- Container for teksten som viser heltens navn og helse -->
            <p id="healer-name-txt">Healerens navn</p>                                      <!-- Legger til en id for hver helt -->
            <p id="healer-health-txt">400 / 400 HP</p>                                      <!-- Legger til en id for hver helt -->
          </div>
        </div>
        <div class="healthbar-container">                                                   <!-- Container for hver enkelt helt -->
                                                                                            <!-- archer-health sin vidde må forandres for å endre lifebar -->
          <div class="healthbar archer-health"></div>                                       <!-- Lifebar for archer -->
          <div class="text-container">                                                      <!-- Container for teksten som viser heltens navn og helse -->
            <p id="archer-name-txt">Archerens navn</p>                                      <!-- Legger til en id for hver helt -->
            <p id="archer-health-txt">600 / 600 HP</p>                                      <!-- Legger til en id for hver helt -->
          </div>
        </div>
        <div class="healthbar-container">                                                   <!-- Container for hver enkelt helt -->
                                                                                            <!-- warrior-health sin vidde må forandres for å endre lifebar -->
          <div class="healthbar warrior-health"></div>                                      <!-- Lifebar for warrior -->
          <div class="text-container">                                                      <!-- Container for teksten som viser heltens navn og helse -->
            <p id="warrior-name-txt">Warriorens navn</p>                                    <!-- Legger til en id for hver helt -->
            <p id="warrior-health-txt">800 / 800 HP</p>                                     <!-- Legger til en id for hver helt -->
          </div>                                                                            <!--Container for teksten som viser heltens navn og helse -->
        </div>                                                                              <!--- Container for hver enkelt helt -->
      </div>                                                                                <!-- Container for alle heltene -->

                                                                                            <!-- Healthbar til fienden -->
      <div class="dragon-health-container">                                                 <!-- Container for dragen -->
        <div class="healthbar-container">                                                   <!-- Container for dragen -->
          <div class="healthbar dragon-health"></div>                                       <!-- Lifebar for dragen -->
          <div class="text-container">                                                      <!-- Container for teksten som viser dragens navn og helse -->
            <p id="dragon-name-txt">Dragens navn</p>                                        <!-- Legger til en id for hver helt -->
            <div class="text-container dragon-health-txt">2000 / 2000 HP</div>              <!-- Legger til en id for hver helt -->
          </div>                                                                            <!-- Container for teksten som viser dragens navn og helse -->
        </div>                                                                              <!-- Container for dragen -->
      </div>                                                                                <!-- Container for dragen -->

                                                                                            <!-- Bildecontainere for heroene -->
      <div class="img-container healer">                                                    <!--Legger til en id for hver helt -->
        <img class="hero" src="assets/healer.png" />                                        <!-- Legger til en id for hver helt -->
      </div>                                                                                <!-- Bildecontainer for healer -->
                                                                                            <!-- Bildecontainer for archer -->
      <div class="img-container archer">                                                    <!--Legger til en id for hver helt -->
        <img class="hero" src="assets/archer.png" />                                        <!-- Legger til en id for hver helt -->
      </div>                                                                                <!-- Bildecontainer for archer -->
                                                                                            <!-- Bildecontainer for warrior -->
      <div class="img-container warrior">                                                   <!--Legger til en id for hver helt -->
        <img class="hero" src="assets/warrior.png" />                                       <!-- Legger til en id for hver helt -->
      </div>                                                                                <!-- Bildecontainer for warrior -->

                                                                                            <!-- Bildecontainer for fienden -->
      <div class="enemy-container">                                                         <!-- Container for dragen -->
        <div class="img-container dragon-container">                                        <!-- Container for dragen -->

                                                                                            <!-- Bildecontainer for dragen -->
          <img class="dragon" src="assets/dragon.png" />                                    <!-- Legger til en id for hver helt -->
        </div>                                                                              <!-- Bildecontainer for dragen -->
      </div>                                                                                <!-- Container for dragen -->
    </div>                                                                                  <!-- Container for hele spillet -->


    <script>
      
                                                                                            // Denne JS-koden er laget klar for deg. Den trenger du ikke endre på.
                                                                                            // Stats for heroes
      let heroesArray = [                                                                   // Array med heltene
        {
          id: 0,                                                                            // ID for helt
          name: "Henriette Healer",                                                         // Navn på helt
          maxHP: 400,                                                                       // Maks helse på helt
          currentHP: 400,                                                                   // Nåværende helse på helt
          damage: 100,                                                                      // Skade helt gjør på dragen
          alive: true,                                                                      // Hvis helt er død, skal denne være false    
        },                                                                                  // Helt 1
        {                                                                                   // Helt 2
          id: 1,                                                                            // ID for helt 
          name: "Ariana Archer",                                                            // Navn på helt
          maxHP: 500,                                                                       // Maks helse på helt
          currentHP: 500,                                                                   // Nåværende helse på helt
          damage: 400,                                                                      // Skade helt gjør på dragen   
          alive: true,                                                                      // Hvis helt er død, skal denne være false
        },                                                                                  // Helt 2
        {                                                                                   // Helt 3
          id: 2,                                                                            // ID for helt
          name: "Wyona Warrior",                                                            // Nav på helt
          maxHP: 600,                                                                       // Maks helse på helt
          currentHP: 600,                                                                   // Nåværende helse på helt
          damage: 400,                                                                      // Skade helt gjør på dragen
          alive: true,                                                                      // Hvis helt er død, skal denne være false
        },                                                                                  // Helt 3
      ];

      let dragonObject = {                                                                  // Stats for dragon
        name: "Daar Dragon",                                                                // Navn på dragen
        maxHP: 2000,                                                                        // Maks helse på dragen
        currentHP: 2000,                                                                    // Nåværende helse på dragen
        damage: 200,                                                                        // Skade dragen gjør på heltene
        alive: true,                                                                        // Hvis dragen er død, skal denne være false
      };

                                                                                                      // Funksjonskrav 1 
                                                                                                      // Når brukeren trykker på en av heltene, skal helten angripe dragen
                                                                                                      // Det skal komme en alert hvor det står:
                                                                                                      // (Heltens name) har gjort (heltens damage) skade på (Dragens name)!”
                                                                                                      // Dragens liv (currentHP) skal bli trukket med heltens damage, 
                                                                                                      // avhengig av hvilken helt den ble angrepet av.
                                                                                                      // Dragens currentHP blir oppdatert i arrayet
                                                                                                      // Når brukeren trykker på en av heltene, skal helten agripe 
                                                                                                      // dragen
  document.addEventListener(`DOMContentLoaded`, (event) => {                                          // Legger til en event listener som venter på at alle dokumentet(HTML) skal være ferdig lastet.Dette sikrer at all HTML er lastet inn før scriptet kjøres
  const dragonHealthTxt = document.querySelector(`.dragon-health-txt`);                               // Henter referansen til elementet som viser dragens nåværende helse,slik at teksten kan oppdateres senere når dragen tar skade
       
  function dragonAttack() {                                                                             // Definerer en funksjon som håndterer logikken for dragens angrep
    const aliveHeroes = heroesArray.filter(hero => hero.alive);                                         // Finner alle helter som er i live
    if (aliveHeroes.length === 0) {                                                                     // Sjekker om det er noen helter igjen å angripe
      alert('Det er ingen helter igjen å angripe!');                                                    // Viser en melding om at det ikke er noen helter igjen å angripe
      return;                                                                                           // Avslutter funksjonen tidlig ved å bruke `return`                                         
    }                                                                                                   // Lukker if-setningen
    const targetHero = aliveHeroes[Math.floor(Math.random() * aliveHeroes.length)];                     // Velger en tilfeldig helt fra "aliveHeroes" arrayet
    targetHero.currentHP -= dragonObject.damage;                                                        // Trekker skaden ("dragonObject.damage") fra heltens nåværende helse ("targetHero.currentHP")
    if (targetHero.currentHP <= 0) {                                                                    // Sjekker om helten er død
      targetHero.currentHP = 0;                                                                         // Setter heltens helse til 0 (for å unngå negative verdier) og markerer helten som død
      targetHero.alive = false;                                                                         // Markerer helten som død
      alert(`${dragonObject.name} har drept ${targetHero.name}!`);                                      // Viser en melding om at dragen har drept helten
    } else {                                                                                            // Hvis helten ikke er død, vis en melding om at dragen har angrepet helten (helsen er over 0)
      alert(`${dragonObject.name} har gjort ${dragonObject.damage} skade på ${targetHero.name}!`);      // Viser en melding om at dragen har angrepet helten
  }                                                                                                     // Lukker if-else - blokken

                                                                                                      // Oppdaterer brukergrensesnittet for heltenes helse
  const heroHealthId = `${targetHero.name.toLowerCase().replace(' ', '-')}-health-txt`;                // Lager en variabel som inneholder id-en til elementet som viser heltenes nåværende helse
  const heroHealthTxt = document.getElementById(targetHero.id); // Henter referansen til elementet som viser heltenes nåværende helse, slik at teksten kan oppdateres senere når helten tar skade
  if (heroHealthTxt) {                                                                                // Sjekker om elementet faktisk finnes før det oppdateres
    heroHealthTxt.textContent = `${targetHero.currentHP} / ${targetHero.maxHP} HP`;                   // Oppdaterer teksten som viser heltenes helse for å reflektere endringene etter angrepet
  }                                                                                                   // Lukker if-setningen
}                                                                                                     // Lukker "dragonAttack" funksjonen
  
function checkIfDragonDead() {                                                                          // Definerer en funksjon som sjekker om dragen er død
      if (!dragonObject.alive) {                                                                        // Sjekker om dragen er død etter angrepet
        alert(`Gratulerer! Dere har vunnet!`);                                                          // Viser en melding om at dragen er død og at spilleren har vunnet
    }                                                                                                   // Lukker if-setningen                                                                                             
  }                                                                                                     // Lukker "checkIfDragonDead" funksjonen

  function attackHero(hero) {                                                                         // Definerer en funksjon "attackHero" som håndterer logikken når en helt angriper dragen
    if (!dragonObject.alive || !hero.alive) {                                                         // Sjekker om dragen eller helten er død. Hvis død, helten ikke angripe
      alert(`${hero.name} kan ikke angripe fordi ${hero.alive ? `dragen` : `helten`} er død!`);       // Viser en melding om at helten ikke kan angripe fordi enten dragen eller helten er død.
      return;                                                                                         // Avslutter funksjonen tidlig ved å bruke `return`
    }                                                                                                 // Lukker if-en

      dragonObject.currentHP -= hero.damage;                                                          // Beregner skade på dragen: Trekker skaden ("hero.damage") fra dragens nåværende helse ("dragonObject.currentHP")

    if (dragonObject.currentHP <= 0) {                                                                // Sjekker om dragen er død. Hvis dragen er død, vil "dragonObject.currentHP" være 0 eller mindre
          dragonObject.currentHP = 0;                                                                 // Setter dragens helse til 0 Ifor å unngå negative verdier) og markerer dragen som død
          dragonObject.alive = false;                                                                 // Markerer dragen som død
          alert(`${hero.name} har drept ${dragonObject.name}!`)                                       // Viser en melding om at helten har drept dragen
          dragonHealthTxt.textContent = `0 / 2000 HP`;                                                // Oppdaterer teksten som viser dragens helse for å reflektere endringene etter angrepet
          checkIfDragonDead();                                                                        // Sjekker om dragen er død etter angrepet
  } else {                                                                                            // Hvis dragen ikke er død, vis en melding om at helten har angrepet dragen (helsen er over 0)
          alert(`${hero.name} har gjort ${hero.damage} skade på ${dragonObject.name}!`);              // Viser en melding om at helten har angrepet dragen
          dragonHealthTxt.textContent =  `${ dragonObject.currentHP } / ${dragonObject.maxHP̋} HP ` ;  // Oppdaterer teksten som viser dragens helse for å reflektere endringene etter angrepet
          dragonAttack();                              
        }                                                                                             // Lukker if-else - blokken
      }                                                                                               // Lukker "attackHero" funksjonen                                                     

    heroesArray.forEach(hero => {                                                                     // Går gjennom hvert "hero" objekt i "heroesArray" med "forEach" metoden
      const heroElement = document.getElementById(hero.name.toLowerCase().replace(` `, `-`));         // Henter DOM elementet for hver helt basert på heltens navn. Dette er gjort ved å bruke heltens navn til å finne elementet i HTML
      if (heroElement) {                                                                              // Sjekker om elementet faktisk finnes før det legges til en event listener
        heroElement.addEventListener(`click`, () => attackHero(hero));                                // Legger til en event listener for "click" hendelsen til hver helt. Når helten klikkes på, vil "attackHero" funksjonen bli kalt med den relevante helten som argument
      }                                                                                               // Lukker if-setningen
    });                                                                                               // Lukker "forEach" løkken for heltene

                                                                                                      // Funksjonskrav 2

                                                                                                      // Dragen skal gjøre et motangrep umiddelbart når den blir angrepet av en helt.
                                                                                                      // - Dragen skal angripe en tilfeldig helt. Det er altså 1⁄3 sjanse for hver helt å bli angrepet.
                                                                                                      // Dragen kan kun angripe helter som er i live, “alive”-propertyen for helten må være true.
                                                                                                      // Det skal komme en ny alert hvor det står:
                                                                                                      // “(Dragens name) har angrepet (Heltens name)!”
                                                                                                      //- Helten som ble angrepet sitt liv (currentHP) skal bli trukket med dragens damage.
                                                                                                      //- Heltens currentHP blir oppdatert i arrayet
                                                                                                      // Påkrevde teknikker: alert, function, onclick/eventListener, manipulering av array-objekter 2

                                                                                                      // Finner IDen basert på heltens navn
  
  if (!heroHealthId) {                                                                                // Sjekker om id-en ble funnet
    console.error("Ukjent helt: " + hero.name);
    return;                                                                                           // Avslutter funksjonen tidlig ved å bruke `return`
  }                                                                                                   // Lukker if-setningen

  const heroHealthElement = document.getElementById(heroHealthId);                                    // Henter referansen til elementet som viser heltenes nåværende helse, slik at teksten kan oppdateres senere når helten tar skade
  if (heroHealthElement) {
    heroHealthElement.textContent = `${hero.currentHP} / ${hero.maxHP} HP`;
  }                                                                                                 // Avslutter "updateHeroHealthTxt" funksjonen
                                                                                                 

                                                                          // Avslutter "Attack "attackHero funksjonen
  heroesArray.forEach(hero => {                                           // Går gjennom hvert "hero" objekt i "heroesArray2 med "foreEach" metoden
    const heroElement = document.getElementById(hero.id);                 // Henter DOM elementet for hver helt basert på heltens id "hero.id"
    heroElement.addEventListener("click", () => attackHero(hero));        // Når klikk på "heroElement" vil funksjonen "attackhero" bli kalt
                                                                          // med den relevante helten(representert) av "hero-objektet" vil angripe.  });
  });                                                                     // Avslutter "forEach" løkken for heltene

                                                                          // Funksjonskrav 3
                                                                          // En helt er død. Dersom en helt sin currentHP blir 0 eller mindre, skal helten(e) forsvinne
                                                                          // fra nettleseren og "alive" propertyen skall bli false. Denne helten er nå død, og dragen
                                                                          // vil ikke vurdere å angripe denne helten. Dersom alle heltene er døde, skal spillet være over
                                                                          // helse) til å vise heltenes nåværende helse sammenlignet med maks helse
  const removeDeadHero = (hero) => {                                      // Definerer en ny funksjon "removeDeadHero", som også tar en "hero" som argument. 
                                                                          // Denne funksjonen vil fjerne den visuelle representasjonen av helten fra nettleseren når helten er død.
  const heroElement = document.getElementById(hero.id);                   // Henter HTML elementet som representer helten, basert på heltenes unike id.
   
  if (heroElement) {                                                      // Sjekker om elementet faktisk finnes før det fjernes fra DOM (Document Object Model)
      heroElement.remove();                                               // Dette hindrer feil hvis elementet allerede er fjernet eller ikke finnes                        
    }                                                                     // Avslutter if setningen
  };                                                                      // Lukker definisjonen av "removeDeadHero" funksjonen.


  function handleHeroDeath(hero) {                                        // Starter definisjonen av "handleHeroDeath" funksjonen som håndterer logikken når en helt dør
    hero.alive = false;                                                   // Markerer helten som død
    const heroElement = document.getElementById(hero.id);                 // Henter DOM elementet for helten basert på heltenes unike id
    if (heroElement) {                                                    // Sjekker om elementet faktisk finnes før det fjernes fra DOM (Document Object Model)
        heroElement.style.display = 'none';                               // Gjemmer elementet, alternativt kan du bruke heroElement.remove() for å fjerne det helt
    }                                                                     // Avslutter if setningen
    
    
    function updateHeroHealthTxt(hero) {                                  // En funksjon "updateHeroHealthTxt" som oppdaterer teksten som viser heltenes helse
                                                                          // Objekt som mapper heltenes navn til deres tilsvarende health text IDer
      const heroHealthIds = {                                             // Objekt som mapper heltenes navn til deres tilsvarende health text IDer
        "Henriette Healer": "healer-health-txt",                          // Henter IDen for helseinformasjonselementet basert på heltens navn
        "Ariana Archer": "archer-health-txt",                             // Henter IDen for helseinformasjonselementet basert på heltens navn
        "Wyona Warrior": "warrior-health-txt"                             // Henter IDen for helseinformasjonselementet basert på heltens navn
    };                                                                    // Lukker objektet som mapper heltenes navn til deres tilsvarende health text IDer

                                                                          // Henter IDen for helseinformasjonselementet basert på heltens navn
      const heroHealthId = heroHealthIds[hero.name];                      // Henter IDen for helseinformasjonselementet basert på heltens navn
      if (!heroHealthId) {                                                // Sjekker om id-en ble funnet
        return;                                                           // Avslutter funksjonen tidlig ved å bruke `return`       // Avslutter funksjonen tidlig ved å bruke `return`
      }                                                                   // Lukker if-setningen
                                                                          
      const heroHealthElement = document.getElementById(heroHealthId);    // Henter referansen til elementet som viser heltenes nåværende helse
        if (heroHealthElement) {                                          // Sjekker om elementet faktisk finnes før det oppdateres
          heroHealthElement.textContent = `${hero.currentHP} / ${hero.maxHP} HP`; // Oppdaterer teksten som viser heltenes helse for å reflektere endringene etter angrepet
    }                                                                     // Avslutter if-setningen
}                                                                         // Avslutter "updateHeroHealthTxt" funksjonen


    updateHeroHealthTxt(hero);                                            // Kaller "updateHeroHealthTxt" funksjonen for å oppdatere brukergrensesnittet med den døde heltens oppdaterte helsetall

    if (heroesArray.every(h => !h.alive)) {                               // Sjekker om alle heltene i "heroesArray" er døde. Dette gjøres ved å bruke "every" metoden for å sjekke om "alive" propertyen er "false" for alle heltene
        alert("Game over! Alle helter er døde.");                         // Viser en "alert" melding om at alle helter er døde og spillet er over
       }                                                                  // Avslutter if setningen
    }                                                                     // Avslutter "handleHeroDeath" funksjonen

                                                                          // Funksjonskrav 4
                                                                          // Lag js kode for game.hmtl filen av denne beskrivelsen:Spillet er tapt!
                                                                          // Dersom alle heltene er døde og dragen har en currentHP over 0, er spillet tapt. Alle heltene skal nå være borte fra skjermen.
                                                                          // En alert skal dukke opp hvor det står:
                                                                          // “Spillet er tapt! (Dragens name) har vunnet!”
function checkGameOver() {                                           

    const allHeroesDead = heroesArray.every((hero) => !hero.alive);     // Sjekker om alle heltene er døde. Hvis alle heltene er døde, vil "hero.alive" være "false" for alle heltene.
                                                    
    const dragonAlive = dragonObject.currentHP > 0;                     // Sjekker om dragen fortsatt er i live. Hvis dragen er død, vil "dragonObject.currentHP" være 0 eller mindre.
                            

  if (allHeroesDead && dragonAlive) {                                   // Fjerner alle helter fra skjermen
    heroesArray.forEach((hero) => {                                     // Går igjennom alle heltene i arrayet "heroesArray" med "forEach" 
      const heroElement = document.getElementById(hero.id);             // Henter DOM elementet for hver helt ved hjelp av heltenes unike id.
      if (heroElement) {                                                // Sjekker om elementet faktisk finnes før det fjernes fra DOM (Document Object Model)
        heroElement.style.display = "none";                             // Dette hindrer feil hvis elementet allerede er fjernet eller ikke finnes
      }                                                                 // Avslutter if setningen
    });                                                                 // Avslutter "forEach" løkken for heltene
                                                                       
    alert(`Spillet er tapt! ${dragonObject.name} har vunnet!`);         // Viser en alert-melding om at spillet er tapt
  }                                                                     // Avslutter "if" setningen
}                                                                       // Avslutter "checkGameOver" funksjonen

                                                                        // Funksjonskrav 5
                                                                        // Spillet er vunnet!
                                                                        // - Dersom dragens currentHP blir 0 eller mindre, har helten(e) vunnet spillet!
                                                                        // - Dragen skal forsvinne fra nettleseren
                                                                        // - En alert skal dukke opp:
                                                                        // “Gratulerer, du har vunnet spillet!”

function checkIfGameIsWon() {                                           // Sjekker om spillet er vunnet. Sjekker om dragens helsepoeng er 0 eller mindre
  if (dragonObject.currentHP <= 0) {                                    // Sjekker om dragens helsepoeng er 0 eller mindre
    const dragonElement = document.getElementById("dragon");            // Anta at dragen har en ID 'dragon'. Henter DOM elementet for dragen ved hjelp av dragenes unike id.
    if (dragonElement) {                                                // Sjekker om elementet faktisk finnes før det fjernes fra DOM (Document Object Model)
      dragonElement.remove();                                           // Dette hindrer feil hvis elementet allerede er fjernet eller ikke finnes
    }                                                                   // Avslutter if setningen
    alert("Gratulerer, du har vunnet spillet!");                        // Viser en alert-melding om at spillet er vunnet
  }                                                                     // Avslutter "if" setningen
}                                                                       // Avslutter "checkIfGameIsWon" funksjonen

const heroHealthIdMap = {                                               // Objekt som mapper heltenes navn til deres tilsvarende health text IDer
  "Henriette Healer": "healer-health-txt",                              // Legger til en id for hver helt
  "Ariana Archer": "archer-health-txt",                                 // Legger til en id for hver helt
  "Wyona Warrior": "warrior-health-txt"                                 // Legger til en id for hver helt
};


const updateHeroHealthTxt = (hero) => {                                       // Definerer en arrow funksjon "updateHeroHealthTxt" som tar en "hero" som argument. Denne funksjonen vil være ansvarlig for å oppdatere heltenes helsevisning i brukergrensesnittet.
  const heroHealthId = heroHealthIdMap[hero.name];                              // Finner IDen basert på heltens navn
  if (heroHealthId) {                                                         // Sjekker om IDen ble funnet
    const heroHealthElement = document.getElementById(heroHealthId);          // Henter referansen til elementet som viser heltenes nåværende helse, slik at teksten kan oppdateres senere når helten tar skade
    heroHealthElement.textContent = `${hero.currentHP} / ${hero.maxHP} HP`;   // Setter innholdet av det valgte elementet (som viser heltenes helse) til å vise heltenes nåværende helse sammenlignet med maks helse
  } else {                                                                    // Hvis IDen ikke ble funnet
    console.error("Ukjent helt: " + hero.name);                               // Skriver en feilmelding til konsollen for å indikere at heltens navn ikke ble gjenkjent
  }                                                                           // Avslutter if-else setningen
};                                                                            // Avslutter "updateHeroHealthTxt" funksjonen
                                                                         
    });                                                                       // Lukker "DOMContentLoaded" event listeneren
    </script>
  </body> 
</html>