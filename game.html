<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arbeidskrav 1!</title>
    <link rel="stylesheet" href="game.css" />
  </head>
  <!-- HTML KODEN TRENGER DU IKKE RØRE FOR Å LØSE OPPGAVENE. -->

  <body>
    <div class="main-container">
      <!-- Healthbars til heroene -->
      <div class="hero-health-containers">
        <div class="healthbar-container">
          <!-- healer-health sin vidde må forandres for å endre lifebar -->
          <div class="healthbar healer-health"></div>
          <div class="text-container">
            <p id="healer-name-txt">Healerens navn</p>
            <p id="healer-health-txt">400 / 400 HP</p>
          </div>
        </div>
        <div class="healthbar-container">
          <!-- archer-health sin vidde må forandres for å endre lifebar -->
          <div class="healthbar archer-health"></div>
          <div class="text-container">
            <p id="archer-name-txt">Archerens navn</p>
            <p id="archer-health-txt">600 / 600 HP</p>
          </div>
        </div>
        <div class="healthbar-container">
          <!-- warrior-health sin vidde må forandres for å endre lifebar -->
          <div class="healthbar warrior-health"></div>
          <div class="text-container">
            <p id="warrior-name-txt">Warriorens navn</p>
            <p id="warrior-health-txt">800 / 800 HP</p>
          </div>
        </div>
      </div>

      <!-- Healthbar til fienden -->
      <div class="dragon-health-container">
        <div class="healthbar-container">
          <!-- dragon-health sin vidde må forandres for å endre lifebar -->
          <div class="healthbar dragon-health"></div>
          <div class="text-container">
            <p id="dragon-name-txt">Dragens navn</p>
            <div class="text-container dragon-health-txt">2000 / 2000 HP</div>
          </div>
        </div>
      </div>

      <!-- Bildecontainere for heroene -->
      <div class="img-container healer">
        <img class="hero" src="assets/healer.png" />
      </div>
      <div class="img-container archer">
        <img class="hero" src="assets/archer.png" />
      </div>
      <div class="img-container warrior">
        <img class="hero" src="assets/warrior.png" />
      </div>

      <!-- Bildecontainer for fienden -->
      <div class="enemy-container">
        <div class="img-container dragon-container">
          <img class="dragon" src="assets/dragon.png" />
        </div>
      </div>
    </div>


    <script>
      
      
      //Denne JS-koden er laget klar for deg. Den trenger du ikke endre på.

      //Stats for heroes
      let heroesArray = [
        {
          id: 0,                    // ID for helt
          name: "Henriette Healer", // Nav på helt
          maxHP: 400,             // Maks helse på helt
          currentHP: 400,         // Nåværende helse på helt
          damage: 100,            // Skade helt gjør på dragen
          alive: true,            // Hvis helt er død, skal denne være false    
        },
        {
          id: 1,                  // ID for helt 
          name: "Ariana archer",  // Nav på helt
          maxHP: 500,             // Maks helse på helt
          currentHP: 500,         // Nåværende helse på helt
          damage: 400,            // Skade helt gjør på dragen   
          alive: true,            // Hvis helt er død, skal denne være false
        },
        {
          id: 2,                  // ID for helt
          name: "Wyona Warrior",  // Nav på helt
          maxHP: 600,             // Maks helse på helt
          currentHP: 600,         // Nåværende helse på helt
          damage: 400,            // Skade helt gjør på dragen
          alive: true,            // Hvis helt er død, skal denne være false
        },
      ];

      let dragonObject = {        // Stats for dragon
        name: "Daar Dragon",      // Navn på dragen
        maxHP: 2000,              // Maks helse på dragen
        currentHP: 2000,          // Nåværende helse på dragen
        damage: 200,              // Skade dragen gjør på heltene
        alive: true,              // Hvis dragen er død, skal denne være false
      };

      // Funksjonskrav 1 
                                                                // Når brukeren trykker på en av heltene, skal helten angripe dragen
                                                                // Det skal komme en alert hvor det står:
                                                                // (Heltens name) har gjort (heltens damage) skade på (Dragens
                                                                // name)!”
                                                                // Dragens liv (currentHP) skal bli trukket med heltens damage, 
                                                                // avhengig av hvilken helt den ble angrepet av.
                                                                // Dragens currentHP blir oppdatert i arrayet

                                                                // Når brukeren trykker på en av heltene, skal helten agripe 
                                                                // dragen
  document.addEventListener(`DOMContentLoaded`, (event) => {    // Legger til en event listener som venter på at alle dokumentet(HTML) skal
                                                                // være ferdig lastet.Dette sikrer at all HTML er lastet inn før scriptet 
                                                                // kjøres
    
                                                                        //Referanse til helseindikatorene i HTML
  const dragonHealthTxT = document.querySelector(`.dragon-health-txt`); // Henter referansen til elementet som viser dragens nåværende helse,
                                                                        // slik at teksten kan oppdateres senere når dragen tar skade
        
  function attackHero(hero) {                                   // Definerer en funksjon "attackHero" som håndterer logikken når en helt angriper dragen
    
    if (!dragonObject.alive || !hero.alive) {                   // Sjekker om dragen eller helten er død. Hvis død, helten ikke angripe
      alert(`${hero.name} kan ikke angripe fordi ${hero.alive ? `dragen` : `helten`} er død!`); // Viser en melding om at helten ikke kan angripe fordi 
                                                                                                // enten dragen eller helten er død.
      return;                                                                                   // Avslutter funksjonen tidlig ved å bruke `return`
    }
      dragonObject.currentHP -= hero.damage;                    // Beregner skade på dragen: Trekker skaden ("hero.damage") fra dragens nåværende helse ("dragonObject.currentHP")

                                                                // Sjekker om dragen er død etter angrepet
      if (dragonObject.currentHP <= 0) {                        // Sjekker om dragen er død. Hvis dragen er død, vil "dragonObject.currentHP" være 0 eller mindre
        dragonObject.currentHP = 0;                             // Setter dragens helse til 0 Ifor å unngå negative verdier) og markerer dragen som død
        dragonObject.alive = false;                             // Markerer dragen som død
        alert(`${hero.name} har drept ${dragonObject.name}!`)   // Viser en melding om at helten har drept dragen
        // dragonHealthTxt.textContent = `0 / 2000 HP`;          // Oppdaterer teksten som viser dragens helse for å reflektere endringene etter angrepet
        checkIfDragonDead();                                    // Sjekker om dragen er død etter angrepet
      } else {                                                  // Hvis dragen ikke er død, vis en melding om at helten har angrepet dragen (helsen er over 0)
        alert(`${hero.name} har gjort ${hero.damage} skade på ${dragonObject.name}!`);  // Viser en melding om at helten har angrepet dragen
        dragonHealthTxt.textContent =  `${ dragonObject.currentHP } / ${dragonObject.maxHP̋} HP ` ; // Oppdaterer teksten som viser dragens helse for å reflektere endringene etter angrepet
        dragonAttack();                              
        }                                                             // Lukker ` attackHero ` funksjonen
      }                                                               // Lukker if-en                                                      
  });

    heroesArray.forEach(hero => {                               // Legg til event listeners for hver helt. Går igjennom hvert `hero`-objekt i med `forEach`metoden` 
      const heroElement = document.getElementById(hero.name.toLowerCase().replace(` `, `-`)); // Henter DOM elementet for hver helt basert på heltenes navn. Forutsetter at ID-en for hver helt
      if (heroElement) {                                        // Sjekker om elementet eksisterer. Hvis ikke, vil `heroElement` være `null` og `addEventListener` vil kaste en feil
        heroElement.addEventListener(`click`, () => attackHero(hero));                          // Legg til en `click`-event listener til hver helt. Når en helt blir klikket på vil `attackHero`- funksjonen
      }                                                                                         // bli kalt med den relevante helten som argument
    });                                                                                         // Lukker `forEach`løkken

    function checkIfDragonDead() {                                // Definerer en funksjon som sjekker om dragen er død
      if (!dragonObject.alive) {                                  // Sjekker om dragen er død etter angrepet
        alert(`Gratulerer! Dere har vunnet!`);                    // Viser en melding om at helten har drept dragen
  }                                                               // Lukker `checkIfDragonDead` funksjonen
}  // Lukker `DOMContentLoaded - event listeneren
    
    //Funksjonskrav 2

// Dragen skal gjøre et motangrep umiddelbart når den blir angrepet av en helt.
// - Dragen skal angripe en tilfeldig helt. Det er altså 1⁄3 sjanse for hver helt å bli angrepet.
// Dragen kan kun angripe helter som er i live, “alive”-propertyen for helten må være true.
// Det skal komme en ny alert hvor det står:
//“(Dragens name) har angrepet (Heltens name)!”
//- Helten som ble angrepet sitt liv (currentHP) skal bli trukket med dragens damage.
//- Heltens currentHP blir oppdatert i arrayet
// Påkrevde teknikker: alert, function, onclick/eventListener, manipulering av array-objekter 2

document.addEventListener("DOMContentLoaded", (event) => {              // Legger til en event listener som venter på at hele dokumentet (HTML) skal være ferdig lastet
  const dragonHealthTxt = document.querySelector(".dragon-health-txt"); // Henter referansen til elementet som viser dragens nåværende helse, slik at teksten kan oppdateres senere når dragen tar skade
  const updateHeroHealthTxt = (hero) => {                               // Definerer en arrow function "updateHeroHealthTxt" som tar en "hero" object som argument. Denne funksjonen
    document.querySelector(                                             // Setter innholdet av det valgte elementet (som viser heltenes helse) til å vise heltenes nåværende helse sammenlignet med maks helse
      `#${hero.id}-health-txt`).textContent = `${hero.currentHP} / ${hero.maxHP} HP`;   // Setter innholdet av det valgte elementet (som viser heltenes helse) til å vise heltenes nåværende helse sammenlignet med maks helse
  };                                                                                    // Lukker definisjonen av "updateHeroHealthTxt" funksjonen

  function dragonAttack() {                                             // Definerer en funksjon "dragonAttack" som håndterer logikken for dragens angrep
    const aliveHeroes = heroesArray.filter((hero) => hero.alive);       // Lager en ny array "aliveHeroes" som inneholder alle helter som er i live
    if (aliveHeroes.length > 0) {                                                         // Sjekker om det finnes helter som fortsatt er i live før dragens angrep utføres
      const targetHero = aliveHeroes[Math.floor(Math.random() * aliveHeroes.length)];     // Velger en tilfeldig helt fra de levende heltene. Bruker "Math.random" for å generere et tilfeldig tall mellom 0 og 1, og multipliserer dette med lengden på "aliveHeroes" gir en indeks for en tilfeldig hel
      targetHero.currentHP -= dragonObject.damage;                                        // Trekk skade fra helten dragen gjør ("dragonObject.damage") fra den valgte heltens nåværende helse ("targetHero.currentHP")
      if (targetHero.currentHP <= 0) {                                                    // Sjekker om helten er død. Hvis helten er død, vil "targetHero.currentHP" være 0 eller mindre
        targetHero.currentHP = 0;                                                         // Setter heltenes nåværende helse til 0 for å forhindre negative helseverdier.
        targetHero.alive = false;                                                         // Markerer helten som død ved å sette "alive" propertyen til "false"
        alert(`${dragonObject.name} har angrepet og drept ${targetHero.name}!`);          // Viser en "alert"-melding om at dragen har angrepet og drept helten
      } else {                                                                            // Hvis helten ikke er død, vis en melding om at dragen har angrepet helten (helsen er over 0)
        alert(`${dragonObject.name} har angrepet ${targetHero.name}!`);                   // Viser en "alert"-melding om at dragen har angrepet helten
      }                                                                                   // Lukker if-else - blokken
      updateHeroHealthTxt(targetHero);                                                    // Kaller "updateHeroHealthTxt" funksjonen for å oppdatere brukergrensesnittet med den angrepne heltens oppdaterte helsetall
      if (aliveHeroes.length === 1 && !targetHero.alive) {                                // Sjekker om dette var den siste levende helten. Hvis "aliveHeroes" kun inneholdt en helt og den helten er nå død, er spillet over.
        alert("Game over! Alle helter er døde.");                                         // Viser en "alert" melding om at alle helter er døde og spillet er over
      }                                                                                   // Avslutter if-blokken
    }                                                                                     // Avslutter "dragonAttack" funksjonen
  }                                                                                       // Avslutter "dragonAttack" funksjonen

  function attackHero(hero) {                                                             // Definerer en funksjon "attackHero" som håndterer logikken når en helt angriper dragen
    if (dragonObject.alive ) {                                                             // Sjekker om dragen fortsatt er i live. Hvis dragen er død, skal den ikke utføre motangrep.
      dragonAttack();                                                                     // Kaller "dragonAttack" funksjonen for å utføre et motangrep umiddelbart etter heltenes angrep
    }                                                                                     // Avslutter if-blokken
  }                                                                                       // Avslutter "Attack "attackHero funksjonen
  heroesArray.forEach((hero) => {                                                         // Går gjennom hvert "hero" objekt i "heroesArray2 med "foreEach" metoden
    const heroElement = document.getElementById(hero.id);                                 // Henter DOM elementet for hver helt basert på heltens id "hero.id"
    heroElement.addEventListener("click", () => attackHero(hero));                        // Når klikk på "heroElement" vil funksjonen "attackhero" bli kalt
                                                                                          // med den relevante helten(representert) av "hero-objektet" vil angripe.  });
  });                                                                                     // Avslutter "forEach" løkken for heltene
});                                                                                       // Avslutter "DOMContentLoaded" event listeneren

    
    
    
    
    
    
    
    </script>
  </body>
</html>
